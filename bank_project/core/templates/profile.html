{% extends "base.html" %}
{% load static %}

{% block title %}Mon Profil{% endblock %}

{% block content %}
<link rel="stylesheet" href="{% static 'css/dashboard.css' %}">

<div class="dashboard">
    
    {% include 'sidebar_user.html' %}

    <main class="main-content">

        <!-- HEAD -->
        <header class="main-header">
            <div class="main-header-left">
                <div class="main-title-row">
                    <span class="main-title-icon">ðŸ‘¤</span>
                    <span class="main-title-text">Mon Profil</span>
                </div>
                <p class="main-subtitle">GÃ©rez vos informations personnelles et votre sÃ©curitÃ©</p>
            </div>
        </header>

        <div class="container-profile">

            <div class="card-profile">

                <!-- MESSAGES -->
                {% if messages %}
                <div class="messages">
                    {% for msg in messages %}
                        <div class="alert {{ msg.tags }}">{{ msg }}</div>
                    {% endfor %}
                </div>
                {% endif %}

                <!-- ============================
                     MODIFIER LE NOM D'UTILISATEUR
                ============================= -->
                <h2>Modifier mon nom d'utilisateur</h2>

                <form method="POST" action="{% url 'profile' %}">
                    {% csrf_token %}

                    <div class="form-group">
                        <label>Nom d'utilisateur</label>
                        <input type="text" name="username" value="{{ user.username }}" required>
                    </div>

                    {% if username_error %}
                        <div class="error-box">{{ username_error }}</div>
                    {% endif %}

                    <button type="submit" class="btn-primary" name="action" value="update_username">
                        Enregistrer
                    </button>
                </form>

                <hr style="border-color: rgba(148,163,184,0.4); margin:20px 0;">

                <!-- ============================
                     MODIFIER LE MOT DE PASSE
                ============================= -->
                <h2>Modifier mon mot de passe</h2>

                <form method="POST" action="{% url 'profile' %}">
                    {% csrf_token %}

                    <div class="form-group">
                        <label>Mot de passe actuel</label>
                        <input type="password" name="old_password" required>
                    </div>

                    <div class="form-group">
                        <label>Nouveau mot de passe</label>
                        <input type="password" name="new_password" required>
                    </div>

                    <div class="form-group">
                        <label>Confirmer le nouveau mot de passe</label>
                        <input type="password" name="confirm_password" required>
                    </div>

                    {% if password_error %}
                        <div class="error-box">{{ password_error }}</div>
                    {% endif %}

                    <button type="submit" class="btn-primary" name="action" value="update_password">
                        Modifier le mot de passe
                    </button>
                </form>

                <hr style="border-color: rgba(148,163,184,0.4); margin:20px 0;">


                <h2>Actions sensibles</h2>

                <a href="{% url 'delete_account_confirm' %}" class="btn-danger" style="margin-bottom:8px;">
                    Supprimer mon compte
                </a>

            </div>
        </div>

    </main>
</div>

{% endblock %}
